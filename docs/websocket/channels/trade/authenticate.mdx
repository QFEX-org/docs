---
title: "Authenticate"
---

Connections to `trade.qfex.com` require authentication. You must authenticate **within 1 minute** of connecting or the server will close the connection.

## How it works

Connect to the private websocket:

- URL: **wss://trade.qfex.com**

Then send an authentication message:

```json
{"type": "auth", "params": {"api_key": "YOUR_API_KEY"}}
```

## Sample Code

<CodeGroup>

```python python
# Python (websocket-client)
# pip install websocket-client
import json
import websocket

def on_open(ws):
    ws.send(json.dumps({ "type": "auth", "params": { "api_key": "YOUR_API_KEY" } }))

def on_message(ws, message):
    print("Message:", message)

def on_error(ws, error):
    print("Error:", error)

def on_close(ws, code, reason):
    print("Closed:", code, reason)

ws = websocket.WebSocketApp(
    "wss://trade.qfex.com",
    on_open=on_open,
    on_message=on_message,
    on_error=on_error,
    on_close=on_close,
)
ws.run_forever()
```

```javascript node
// Node.js (ws)
// npm i ws
import WebSocket from "ws";

const ws = new WebSocket("wss://trade.qfex.com");

ws.on("open", () => {
  ws.send(
    JSON.stringify({ type: "auth", params: { api_key: "YOUR_API_KEY" } })
  );
});

ws.on("message", (msg) => {
  console.log("Message:", msg.toString());
});

ws.on("error", (err) => console.error("WS error:", err));
ws.on("close", (code, reason) =>
  console.log("Closed:", code, reason?.toString())
);
```

```go go
// Go (gorilla/websocket)
// go get github.com/gorilla/websocket
package main

import (
	"fmt"
	"log"
	"os"
	"os/signal"

	"github.com/gorilla/websocket"
)

func main() {
	c, _, err := websocket.DefaultDialer.Dial("wss://trade.qfex.com", nil)
	if err != nil {
		log.Fatal("dial:", err)
	}
	defer c.Close()

	auth := map[string]any{
		"type": "auth",
		"params": map[string]string{
			"api_key": "YOUR_API_KEY",
		},
	}
	if err := c.WriteJSON(auth); err != nil {
		log.Fatal("write auth:", err)
	}

	done := make(chan struct{})
	go func() {
		defer close(done)
		for {
			_, message, err := c.ReadMessage()
			if err != nil {
				log.Println("read:", err)
				return
			}
			fmt.Printf("Message: %s\n", message)
		}
	}()

	interrupt := make(chan os.Signal, 1)
	signal.Notify(interrupt, os.Interrupt)
	<-interrupt
}
```

```java java
// Java (OkHttp WebSocket)
// Gradle: implementation("com.squareup.okhttp3:okhttp:4.12.0")
import java.util.concurrent.TimeUnit;
import okhttp3.*;

public class AuthWs {
  public static void main(String[] args) {
    OkHttpClient client = new OkHttpClient.Builder()
        .pingInterval(20, TimeUnit.SECONDS)
        .build();

    Request request = new Request.Builder()
        .url("wss://trade.qfex.com")
        .build();

    WebSocketListener listener = new WebSocketListener() {
      @Override public void onOpen(WebSocket ws, Response response) {
        ws.send("{\"type\":\"auth\",\"params\":{\"api_key\":\"YOUR_API_KEY\"}}");
      }
      @Override public void onMessage(WebSocket ws, String text) {
        System.out.println("Message: " + text);
      }
      @Override public void onFailure(WebSocket ws, Throwable t, Response r) {
        System.err.println("WS error: " + t.getMessage());
      }
    };

    client.newWebSocket(request, listener);

    try { Thread.sleep(Long.MAX_VALUE); } catch (InterruptedException ignored) {}
  }
}
```

</CodeGroup>

## Example Response

```json
{ "type": "auth", "result": "success" }
```
